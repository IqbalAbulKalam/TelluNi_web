/**
 * Core Philosophy: This ruleset establishes a "public read, locked write" security model.
 * All users, whether authenticated or not, can read data from any collection. This is
 * designed for a public-facing landing page or catalog where content like designs,
 * reviews, and gallery images is meant for general consumption. All write operations
 * (create, update, delete) are disabled by default, anticipating that a future
 * admin role will be implemented to manage this content.
 *
 * Data Structure: The data is organized into three flat, top-level collections:
 * - /bajuBodoDesigns: Stores clothing design information.
 * - /customerReviews: Contains user-submitted reviews.
 * - /customerGalleryImages: Holds images for a public gallery.
 * There is no user-specific data or nesting, simplifying the rules.
 *
 * Key Security Decisions:
 * - Public Read Access: All collections are world-readable to support the public-facing
 *   nature of the application.
 * - Default Deny on Writes: To prevent vandalism or unauthorized content modification,
 *   all write operations are explicitly denied. This provides a secure-by-default
 *   posture until an administrative role system is implemented.
 * - No User Ownership: The data models do not contain ownerId or authorId fields,
 *   which means rules cannot grant write permissions to specific users. The ruleset
 *   reflects this by locking all writes globally.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ------------------------------------------------------------------------
    // Helper Functions
    // ------------------------------------------------------------------------

    /**
     * Checks if the user is authenticated.
     */
    function isSignedIn() {
      return request.auth != null;
    }

    // ------------------------------------------------------------------------
    // Collection: bajuBodoDesigns
    // ------------------------------------------------------------------------

    /**
     * @description Publicly readable collection of Baju Bodo designs. All write
     *              operations are disabled pending the implementation of an admin system.
     * @path /bajuBodoDesigns/{bajuBodoDesignId}
     * @allow An anonymous (not signed-in) user can read a specific design document. (get)
     * @deny Any user, authenticated or not, attempting to create a new design document. (create)
     * @principle Ensures catalog data is publicly visible but prevents modification by unauthorized users.
     */
    match /bajuBodoDesigns/{bajuBodoDesignId} {
      allow get: if true;
      allow list: if true;
      allow create: if false; // TODO: Implement admin-only creation logic.
      allow update: if false; // TODO: Implement admin-only update logic.
      allow delete: if false; // TODO: Implement admin-only deletion logic.
    }

    // ------------------------------------------------------------------------
    // Collection: customerReviews
    // ------------------------------------------------------------------------

    /**
     * @description Publicly readable collection of customer reviews. All write
     *              operations are disabled. This prevents spam or unverified reviews
     *              until a proper submission and moderation flow is built.
     * @path /customerReviews/{customerReviewId}
     * @allow Any user can list all customer reviews. (list)
     * @deny An authenticated user attempting to update an existing review. (update)
     * @principle Protects the integrity of public-facing content by restricting writes to future trusted roles.
     */
    match /customerReviews/{customerReviewId} {
      allow get: if true;
      allow list: if true;
      allow create: if false; // TODO: Implement a secure review submission rule (e.g., owner-only or admin-moderated).
      allow update: if false; // TODO: Implement admin-only update/moderation logic.
      allow delete: if false; // TODO: Implement admin-only deletion/moderation logic.
    }

    // ------------------------------------------------------------------------
    // Collection: customerGalleryImages
    // ------------------------------------------------------------------------

    /**
     * @description Publicly readable collection of customer gallery images. All write
     *              operations are disabled pending the implementation of an admin system.
     * @path /customerGalleryImages/{customerGalleryImageId}
     * @allow An anonymous user can view a specific gallery image. (get)
     * @deny Any user attempting to delete a gallery image. (delete)
     * @principle Ensures gallery content is publicly visible but managed centrally.
     */
    match /customerGalleryImages/{customerGalleryImageId} {
      allow get: if true;
      allow list: if true;
      allow create: if false; // TODO: Implement admin-only creation logic.
      allow update: if false; // TODO: Implement admin-only update logic.
      allow delete: if false; // TODO: Implement admin-only deletion logic.
    }
  }
}